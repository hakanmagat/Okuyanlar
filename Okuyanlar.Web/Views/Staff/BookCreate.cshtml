@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@model Okuyanlar.Core.Entities.Book

@{
    ViewData["Title"] = "Add Book";
}

<div class="ok-section" style="padding-top:2rem; padding-bottom:2rem;">
    <div class="container ok-container">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-md-10">

                <div class="ok-card">
                    <!-- Header -->
                    <div class="ok-card-header" style="display:flex; align-items:center; justify-content:space-between;">
                        <div style="display:flex; align-items:center; gap:.75rem;">
                            <div style="
                                width:44px;height:44px;border-radius:12px;
                                background: rgba(197,160,89,.18);
                                display:flex;align-items:center;justify-content:center;
                                border:1px solid rgba(255,255,255,.16);
                            ">
                                <i class="bi bi-journal-plus" style="font-size:1.2rem; color:#fff;"></i>
                            </div>
                            <div>
                                <div style="font-size:1.1rem; font-weight:900; line-height:1.2;">Add New Book</div>
                                <div style="opacity:.9; font-weight:700; font-size:.9rem;">Create an inventory record</div>
                            </div>
                        </div>

                        <span class="ok-badge ok-badge-accent" style="font-weight:900;">
                            New
                        </span>
                    </div>

                    <!-- Body -->
                    <div class="ok-card-body">
                        <form asp-controller="Staff" asp-action="BookCreate" method="post" id="bookCreateForm">
                            @Html.AntiForgeryToken()

                            <div asp-validation-summary="ModelOnly" class="text-danger mb-3" style="font-weight:800;"></div>

                            <div class="row">
                                <div class="col-md-6 ok-mb-3">
                                    <label asp-for="Title" class="ok-form-label">Book Title</label>
                                    <input asp-for="Title" class="ok-form-control" placeholder="e.g. Clean Code" />
                                    <span asp-validation-for="Title" class="text-danger small" style="font-weight:800;"></span>
                                </div>

                                <div class="col-md-6 ok-mb-3">
                                    <label asp-for="Author" class="ok-form-label">Author</label>
                                    <input asp-for="Author" class="ok-form-control" placeholder="e.g. Robert C. Martin" />
                                    <span asp-validation-for="Author" class="text-danger small" style="font-weight:800;"></span>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6 ok-mb-3">
                                    <label asp-for="ISBN" class="ok-form-label">ISBN</label>
                                    <input asp-for="ISBN" class="ok-form-control" placeholder="978-..." />
                                    <span asp-validation-for="ISBN" class="text-danger small" style="font-weight:800;"></span>
                                </div>

                                <div class="col-md-6 ok-mb-3">
                                    <label asp-for="Stock" class="ok-form-label">Stock Quantity</label>
                                    <input asp-for="Stock" class="ok-form-control" type="number" min="0" value="1" />
                                    <span asp-validation-for="Stock" class="text-danger small" style="font-weight:800;"></span>
                                </div>
                            </div>

                            <!-- Availability toggle -->
                            <div class="ok-card ok-mt-2" style="box-shadow: var(--ok-shadow-sm); border-radius:14px; box-color: white;">
                                <div class="ok-card-body" style="padding: 1rem 1.25rem;">
                                    <div class="ok-flex ok-items-center ok-justify-between ok-flex-wrap ok-gap-2">
                                        <div>
                                            <div style="font-weight:900; color:var(--ok-title);">
                                                Availability
                                            </div>
                                            <div style="opacity:.8; font-weight:700; font-size:.9rem;">
                                                Mark as available for borrowing once created.
                                            </div>
                                        </div>

                                        <div class="form-check form-switch" style="margin:0;">
                                            <input asp-for="IsActive" class="form-check-input" id="isActiveSwitchCreate" checked />
                                            <label class="form-check-label" for="isActiveSwitchCreate" style="font-weight:800;">
                                                Is Available for Borrowing?
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Actions -->
                            <div class="ok-mt-4 ok-flex ok-justify-between ok-items-center ok-gap-2 ok-flex-wrap">
                                <a asp-action="Index" class="btn-ok-secondary" style="text-align:center; min-width:160px;">
                                    <i class="bi bi-x-circle me-2"></i> Cancel
                                </a>

                                <button type="submit" class="btn-ok-primary" style="min-width:220px;">
                                    <i class="bi bi-save2 me-2"></i> Save to Inventory
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Footer -->
                    <div class="ok-card-footer" style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:.75rem;">
                        <small style="opacity:.75; font-weight:800;">Fill in details carefully; ISBN helps deduplication.</small>
                        <small style="opacity:.75; font-weight:800;">Okuyanlar â€¢ Staff Tools</small>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        // Optional: add validation + loading + toast on submit
        document.addEventListener("DOMContentLoaded", function () {
            var form = document.getElementById("bookCreateForm");
            if (!form) return;

            form.addEventListener("submit", function (e) {
                if (window.OkValidation && !OkValidation.validate(form)) {
                    e.preventDefault();
                    if (window.OkToast) OkToast.error("Please check the form fields.", "Validation");
                    return;
                }
                if (window.OkLoading) OkLoading.show();
            });
        });
    </script>
}
